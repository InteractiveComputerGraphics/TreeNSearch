#pragma once
#include <array>
#include <immintrin.h>

namespace tns
{
	namespace internals
	{
		inline __m256 compress256(__m256 src, unsigned int mask /* from movmskps */)
		{
			uint64_t expanded_mask = _pdep_u64(mask, 0x0101010101010101);  // unpack each bit to a byte
			expanded_mask *= 0xFF;    // mask |= mask<<1 | mask<<2 | ... | mask<<7;
			// ABC... -> AAAAAAAABBBBBBBBCCCCCCCC...: replicate each bit to fill its byte

			const uint64_t identity_indices = 0x0706050403020100;    // the identity shuffle for vpermps, packed to one index per byte
			uint64_t wanted_indices = _pext_u64(identity_indices, expanded_mask);

			__m128i bytevec = _mm_cvtsi64_si128(wanted_indices);
			__m256i shufmask = _mm256_cvtepu8_epi32(bytevec);

			return _mm256_permutevar8x32_ps(src, shufmask);
		}

		// a >= b  ->  b < a + 1
		inline __m128i _mm_cmpge_epi16(const __m128i& a, const __m128i& b)
		{
			return _mm_cmplt_epi16(b, _mm_add_epi16(a, _mm_set1_epi16(1)));
		}

		inline void xyzxyz_to_xxyyzz(__m256& x, __m256& y, __m256& z, const float* p)
		{
			// https://www.intel.com/content/dam/develop/external/us/en/documents/normvec-181650.pdf
			__m256 m03;
			__m256 m14;
			__m256 m25;
			m03 = _mm256_castps128_ps256(_mm_loadu_ps(p)); // load lower halves
			m14 = _mm256_castps128_ps256(_mm_loadu_ps(p + 4));
			m25 = _mm256_castps128_ps256(_mm_loadu_ps(p + 8));
			m03 = _mm256_insertf128_ps(m03, _mm_loadu_ps(p + 12), 1); // load upper halves
			m14 = _mm256_insertf128_ps(m14, _mm_loadu_ps(p + 16), 1);
			m25 = _mm256_insertf128_ps(m25, _mm_loadu_ps(p + 20), 1);

			__m256 xy = _mm256_shuffle_ps(m14, m25, _MM_SHUFFLE(2, 1, 3, 2)); // upper x's and y's 
			__m256 yz = _mm256_shuffle_ps(m03, m14, _MM_SHUFFLE(1, 0, 2, 1)); // lower y's and z's 
			x = _mm256_shuffle_ps(m03, xy, _MM_SHUFFLE(2, 0, 3, 0));
			y = _mm256_shuffle_ps(yz, xy, _MM_SHUFFLE(3, 1, 2, 0));
			z = _mm256_shuffle_ps(yz, m25, _MM_SHUFFLE(3, 0, 3, 1));
		}

		inline void xyzxyz_to_xxyyzz(__m256& x, __m256& y, __m256& z, const float* p, const uint8_t n, const float fill)
		{
			switch (n)
			{
			case static_cast<uint8_t>(0):
				x = _mm256_setr_ps(fill, fill, fill, fill, fill, fill, fill, fill);
				y = _mm256_setr_ps(fill, fill, fill, fill, fill, fill, fill, fill);
				z = _mm256_setr_ps(fill, fill, fill, fill, fill, fill, fill, fill);
				break;
			case static_cast<uint8_t>(1):
				x = _mm256_setr_ps(p[0], fill, fill, fill, fill, fill, fill, fill);
				y = _mm256_setr_ps(p[1], fill, fill, fill, fill, fill, fill, fill);
				z = _mm256_setr_ps(p[2], fill, fill, fill, fill, fill, fill, fill);
				break;
			case static_cast<uint8_t>(2):
				x = _mm256_setr_ps(p[0], p[3], fill, fill, fill, fill, fill, fill);
				y = _mm256_setr_ps(p[1], p[4], fill, fill, fill, fill, fill, fill);
				z = _mm256_setr_ps(p[2], p[5], fill, fill, fill, fill, fill, fill);
				break;
			case static_cast<uint8_t>(3):
				x = _mm256_setr_ps(p[0], p[3], p[6], fill, fill, fill, fill, fill);
				y = _mm256_setr_ps(p[1], p[4], p[7], fill, fill, fill, fill, fill);
				z = _mm256_setr_ps(p[2], p[5], p[8], fill, fill, fill, fill, fill);
				break;
			case static_cast<uint8_t>(4):
				x = _mm256_setr_ps(p[0], p[3], p[6], p[9], fill, fill, fill, fill);
				y = _mm256_setr_ps(p[1], p[4], p[7], p[10], fill, fill, fill, fill);
				z = _mm256_setr_ps(p[2], p[5], p[8], p[11], fill, fill, fill, fill);
				break;
			case static_cast<uint8_t>(5):
				x = _mm256_setr_ps(p[0], p[3], p[6], p[9], p[12], fill, fill, fill);
				y = _mm256_setr_ps(p[1], p[4], p[7], p[10], p[13], fill, fill, fill);
				z = _mm256_setr_ps(p[2], p[5], p[8], p[11], p[14], fill, fill, fill);
				break;
			case static_cast<uint8_t>(6):
				x = _mm256_setr_ps(p[0], p[3], p[6], p[9], p[12], p[15], fill, fill);
				y = _mm256_setr_ps(p[1], p[4], p[7], p[10], p[13], p[16], fill, fill);
				z = _mm256_setr_ps(p[2], p[5], p[8], p[11], p[14], p[17], fill, fill);
				break;
			case static_cast<uint8_t>(7):
				x = _mm256_setr_ps(p[0], p[3], p[6], p[9], p[12], p[15], p[18], fill);
				y = _mm256_setr_ps(p[1], p[4], p[7], p[10], p[13], p[16], p[19], fill);
				z = _mm256_setr_ps(p[2], p[5], p[8], p[11], p[14], p[17], p[20], fill);
				break;
			case static_cast<uint8_t>(8):
				x = _mm256_setr_ps(p[0], p[3], p[6], p[9], p[12], p[15], p[18], p[21]);
				y = _mm256_setr_ps(p[1], p[4], p[7], p[10], p[13], p[16], p[19], p[22]);
				z = _mm256_setr_ps(p[2], p[5], p[8], p[11], p[14], p[17], p[20], p[23]);
				break;
			default:
				break;
			}
		}

		const static __m256i epi32_to_epi16_mask128 = _mm256_setr_epi8(0, 1, 4, 5, 8, 9, 12, 13, 0, 0, 0, 0, 0, 0, 0, 0, 16, 17, 20, 21, 24, 25, 28, 29, 0, 0, 0, 0, 0, 0, 0, 0);
		const static __m128i epi16_to_epi8_cmp_mask = _mm_setr_epi8(0, 2, 4, 6, 8, 10, 12, 14, -1, -1, -1, -1, -1, -1, -1, -1);

		constexpr static uint32_t shift_lut_32[256][8] = {
			{0, 0, 0, 0, 0, 0, 0, 0}, // 0
			{0, 0, 0, 0, 0, 0, 0, 0}, // 1
			{1, 0, 0, 0, 0, 0, 0, 0}, // 2
			{0, 1, 0, 0, 0, 0, 0, 0}, // 3
			{2, 0, 0, 0, 0, 0, 0, 0}, // 4
			{0, 2, 0, 0, 0, 0, 0, 0}, // 5
			{1, 2, 0, 0, 0, 0, 0, 0}, // 6
			{0, 1, 2, 0, 0, 0, 0, 0}, // 7
			{3, 0, 0, 0, 0, 0, 0, 0}, // 8
			{0, 3, 0, 0, 0, 0, 0, 0}, // 9
			{1, 3, 0, 0, 0, 0, 0, 0}, // 10
			{0, 1, 3, 0, 0, 0, 0, 0}, // 11
			{2, 3, 0, 0, 0, 0, 0, 0}, // 12
			{0, 2, 3, 0, 0, 0, 0, 0}, // 13
			{1, 2, 3, 0, 0, 0, 0, 0}, // 14
			{0, 1, 2, 3, 0, 0, 0, 0}, // 15
			{4, 0, 0, 0, 0, 0, 0, 0}, // 16
			{0, 4, 0, 0, 0, 0, 0, 0}, // 17
			{1, 4, 0, 0, 0, 0, 0, 0}, // 18
			{0, 1, 4, 0, 0, 0, 0, 0}, // 19
			{2, 4, 0, 0, 0, 0, 0, 0}, // 20
			{0, 2, 4, 0, 0, 0, 0, 0}, // 21
			{1, 2, 4, 0, 0, 0, 0, 0}, // 22
			{0, 1, 2, 4, 0, 0, 0, 0}, // 23
			{3, 4, 0, 0, 0, 0, 0, 0}, // 24
			{0, 3, 4, 0, 0, 0, 0, 0}, // 25
			{1, 3, 4, 0, 0, 0, 0, 0}, // 26
			{0, 1, 3, 4, 0, 0, 0, 0}, // 27
			{2, 3, 4, 0, 0, 0, 0, 0}, // 28
			{0, 2, 3, 4, 0, 0, 0, 0}, // 29
			{1, 2, 3, 4, 0, 0, 0, 0}, // 30
			{0, 1, 2, 3, 4, 0, 0, 0}, // 31
			{5, 0, 0, 0, 0, 0, 0, 0}, // 32
			{0, 5, 0, 0, 0, 0, 0, 0}, // 33
			{1, 5, 0, 0, 0, 0, 0, 0}, // 34
			{0, 1, 5, 0, 0, 0, 0, 0}, // 35
			{2, 5, 0, 0, 0, 0, 0, 0}, // 36
			{0, 2, 5, 0, 0, 0, 0, 0}, // 37
			{1, 2, 5, 0, 0, 0, 0, 0}, // 38
			{0, 1, 2, 5, 0, 0, 0, 0}, // 39
			{3, 5, 0, 0, 0, 0, 0, 0}, // 40
			{0, 3, 5, 0, 0, 0, 0, 0}, // 41
			{1, 3, 5, 0, 0, 0, 0, 0}, // 42
			{0, 1, 3, 5, 0, 0, 0, 0}, // 43
			{2, 3, 5, 0, 0, 0, 0, 0}, // 44
			{0, 2, 3, 5, 0, 0, 0, 0}, // 45
			{1, 2, 3, 5, 0, 0, 0, 0}, // 46
			{0, 1, 2, 3, 5, 0, 0, 0}, // 47
			{4, 5, 0, 0, 0, 0, 0, 0}, // 48
			{0, 4, 5, 0, 0, 0, 0, 0}, // 49
			{1, 4, 5, 0, 0, 0, 0, 0}, // 50
			{0, 1, 4, 5, 0, 0, 0, 0}, // 51
			{2, 4, 5, 0, 0, 0, 0, 0}, // 52
			{0, 2, 4, 5, 0, 0, 0, 0}, // 53
			{1, 2, 4, 5, 0, 0, 0, 0}, // 54
			{0, 1, 2, 4, 5, 0, 0, 0}, // 55
			{3, 4, 5, 0, 0, 0, 0, 0}, // 56
			{0, 3, 4, 5, 0, 0, 0, 0}, // 57
			{1, 3, 4, 5, 0, 0, 0, 0}, // 58
			{0, 1, 3, 4, 5, 0, 0, 0}, // 59
			{2, 3, 4, 5, 0, 0, 0, 0}, // 60
			{0, 2, 3, 4, 5, 0, 0, 0}, // 61
			{1, 2, 3, 4, 5, 0, 0, 0}, // 62
			{0, 1, 2, 3, 4, 5, 0, 0}, // 63
			{6, 0, 0, 0, 0, 0, 0, 0}, // 64
			{0, 6, 0, 0, 0, 0, 0, 0}, // 65
			{1, 6, 0, 0, 0, 0, 0, 0}, // 66
			{0, 1, 6, 0, 0, 0, 0, 0}, // 67
			{2, 6, 0, 0, 0, 0, 0, 0}, // 68
			{0, 2, 6, 0, 0, 0, 0, 0}, // 69
			{1, 2, 6, 0, 0, 0, 0, 0}, // 70
			{0, 1, 2, 6, 0, 0, 0, 0}, // 71
			{3, 6, 0, 0, 0, 0, 0, 0}, // 72
			{0, 3, 6, 0, 0, 0, 0, 0}, // 73
			{1, 3, 6, 0, 0, 0, 0, 0}, // 74
			{0, 1, 3, 6, 0, 0, 0, 0}, // 75
			{2, 3, 6, 0, 0, 0, 0, 0}, // 76
			{0, 2, 3, 6, 0, 0, 0, 0}, // 77
			{1, 2, 3, 6, 0, 0, 0, 0}, // 78
			{0, 1, 2, 3, 6, 0, 0, 0}, // 79
			{4, 6, 0, 0, 0, 0, 0, 0}, // 80
			{0, 4, 6, 0, 0, 0, 0, 0}, // 81
			{1, 4, 6, 0, 0, 0, 0, 0}, // 82
			{0, 1, 4, 6, 0, 0, 0, 0}, // 83
			{2, 4, 6, 0, 0, 0, 0, 0}, // 84
			{0, 2, 4, 6, 0, 0, 0, 0}, // 85
			{1, 2, 4, 6, 0, 0, 0, 0}, // 86
			{0, 1, 2, 4, 6, 0, 0, 0}, // 87
			{3, 4, 6, 0, 0, 0, 0, 0}, // 88
			{0, 3, 4, 6, 0, 0, 0, 0}, // 89
			{1, 3, 4, 6, 0, 0, 0, 0}, // 90
			{0, 1, 3, 4, 6, 0, 0, 0}, // 91
			{2, 3, 4, 6, 0, 0, 0, 0}, // 92
			{0, 2, 3, 4, 6, 0, 0, 0}, // 93
			{1, 2, 3, 4, 6, 0, 0, 0}, // 94
			{0, 1, 2, 3, 4, 6, 0, 0}, // 95
			{5, 6, 0, 0, 0, 0, 0, 0}, // 96
			{0, 5, 6, 0, 0, 0, 0, 0}, // 97
			{1, 5, 6, 0, 0, 0, 0, 0}, // 98
			{0, 1, 5, 6, 0, 0, 0, 0}, // 99
			{2, 5, 6, 0, 0, 0, 0, 0}, // 100
			{0, 2, 5, 6, 0, 0, 0, 0}, // 101
			{1, 2, 5, 6, 0, 0, 0, 0}, // 102
			{0, 1, 2, 5, 6, 0, 0, 0}, // 103
			{3, 5, 6, 0, 0, 0, 0, 0}, // 104
			{0, 3, 5, 6, 0, 0, 0, 0}, // 105
			{1, 3, 5, 6, 0, 0, 0, 0}, // 106
			{0, 1, 3, 5, 6, 0, 0, 0}, // 107
			{2, 3, 5, 6, 0, 0, 0, 0}, // 108
			{0, 2, 3, 5, 6, 0, 0, 0}, // 109
			{1, 2, 3, 5, 6, 0, 0, 0}, // 110
			{0, 1, 2, 3, 5, 6, 0, 0}, // 111
			{4, 5, 6, 0, 0, 0, 0, 0}, // 112
			{0, 4, 5, 6, 0, 0, 0, 0}, // 113
			{1, 4, 5, 6, 0, 0, 0, 0}, // 114
			{0, 1, 4, 5, 6, 0, 0, 0}, // 115
			{2, 4, 5, 6, 0, 0, 0, 0}, // 116
			{0, 2, 4, 5, 6, 0, 0, 0}, // 117
			{1, 2, 4, 5, 6, 0, 0, 0}, // 118
			{0, 1, 2, 4, 5, 6, 0, 0}, // 119
			{3, 4, 5, 6, 0, 0, 0, 0}, // 120
			{0, 3, 4, 5, 6, 0, 0, 0}, // 121
			{1, 3, 4, 5, 6, 0, 0, 0}, // 122
			{0, 1, 3, 4, 5, 6, 0, 0}, // 123
			{2, 3, 4, 5, 6, 0, 0, 0}, // 124
			{0, 2, 3, 4, 5, 6, 0, 0}, // 125
			{1, 2, 3, 4, 5, 6, 0, 0}, // 126
			{0, 1, 2, 3, 4, 5, 6, 0}, // 127
			{7, 0, 0, 0, 0, 0, 0, 0}, // 128
			{0, 7, 0, 0, 0, 0, 0, 0}, // 129
			{1, 7, 0, 0, 0, 0, 0, 0}, // 130
			{0, 1, 7, 0, 0, 0, 0, 0}, // 131
			{2, 7, 0, 0, 0, 0, 0, 0}, // 132
			{0, 2, 7, 0, 0, 0, 0, 0}, // 133
			{1, 2, 7, 0, 0, 0, 0, 0}, // 134
			{0, 1, 2, 7, 0, 0, 0, 0}, // 135
			{3, 7, 0, 0, 0, 0, 0, 0}, // 136
			{0, 3, 7, 0, 0, 0, 0, 0}, // 137
			{1, 3, 7, 0, 0, 0, 0, 0}, // 138
			{0, 1, 3, 7, 0, 0, 0, 0}, // 139
			{2, 3, 7, 0, 0, 0, 0, 0}, // 140
			{0, 2, 3, 7, 0, 0, 0, 0}, // 141
			{1, 2, 3, 7, 0, 0, 0, 0}, // 142
			{0, 1, 2, 3, 7, 0, 0, 0}, // 143
			{4, 7, 0, 0, 0, 0, 0, 0}, // 144
			{0, 4, 7, 0, 0, 0, 0, 0}, // 145
			{1, 4, 7, 0, 0, 0, 0, 0}, // 146
			{0, 1, 4, 7, 0, 0, 0, 0}, // 147
			{2, 4, 7, 0, 0, 0, 0, 0}, // 148
			{0, 2, 4, 7, 0, 0, 0, 0}, // 149
			{1, 2, 4, 7, 0, 0, 0, 0}, // 150
			{0, 1, 2, 4, 7, 0, 0, 0}, // 151
			{3, 4, 7, 0, 0, 0, 0, 0}, // 152
			{0, 3, 4, 7, 0, 0, 0, 0}, // 153
			{1, 3, 4, 7, 0, 0, 0, 0}, // 154
			{0, 1, 3, 4, 7, 0, 0, 0}, // 155
			{2, 3, 4, 7, 0, 0, 0, 0}, // 156
			{0, 2, 3, 4, 7, 0, 0, 0}, // 157
			{1, 2, 3, 4, 7, 0, 0, 0}, // 158
			{0, 1, 2, 3, 4, 7, 0, 0}, // 159
			{5, 7, 0, 0, 0, 0, 0, 0}, // 160
			{0, 5, 7, 0, 0, 0, 0, 0}, // 161
			{1, 5, 7, 0, 0, 0, 0, 0}, // 162
			{0, 1, 5, 7, 0, 0, 0, 0}, // 163
			{2, 5, 7, 0, 0, 0, 0, 0}, // 164
			{0, 2, 5, 7, 0, 0, 0, 0}, // 165
			{1, 2, 5, 7, 0, 0, 0, 0}, // 166
			{0, 1, 2, 5, 7, 0, 0, 0}, // 167
			{3, 5, 7, 0, 0, 0, 0, 0}, // 168
			{0, 3, 5, 7, 0, 0, 0, 0}, // 169
			{1, 3, 5, 7, 0, 0, 0, 0}, // 170
			{0, 1, 3, 5, 7, 0, 0, 0}, // 171
			{2, 3, 5, 7, 0, 0, 0, 0}, // 172
			{0, 2, 3, 5, 7, 0, 0, 0}, // 173
			{1, 2, 3, 5, 7, 0, 0, 0}, // 174
			{0, 1, 2, 3, 5, 7, 0, 0}, // 175
			{4, 5, 7, 0, 0, 0, 0, 0}, // 176
			{0, 4, 5, 7, 0, 0, 0, 0}, // 177
			{1, 4, 5, 7, 0, 0, 0, 0}, // 178
			{0, 1, 4, 5, 7, 0, 0, 0}, // 179
			{2, 4, 5, 7, 0, 0, 0, 0}, // 180
			{0, 2, 4, 5, 7, 0, 0, 0}, // 181
			{1, 2, 4, 5, 7, 0, 0, 0}, // 182
			{0, 1, 2, 4, 5, 7, 0, 0}, // 183
			{3, 4, 5, 7, 0, 0, 0, 0}, // 184
			{0, 3, 4, 5, 7, 0, 0, 0}, // 185
			{1, 3, 4, 5, 7, 0, 0, 0}, // 186
			{0, 1, 3, 4, 5, 7, 0, 0}, // 187
			{2, 3, 4, 5, 7, 0, 0, 0}, // 188
			{0, 2, 3, 4, 5, 7, 0, 0}, // 189
			{1, 2, 3, 4, 5, 7, 0, 0}, // 190
			{0, 1, 2, 3, 4, 5, 7, 0}, // 191
			{6, 7, 0, 0, 0, 0, 0, 0}, // 192
			{0, 6, 7, 0, 0, 0, 0, 0}, // 193
			{1, 6, 7, 0, 0, 0, 0, 0}, // 194
			{0, 1, 6, 7, 0, 0, 0, 0}, // 195
			{2, 6, 7, 0, 0, 0, 0, 0}, // 196
			{0, 2, 6, 7, 0, 0, 0, 0}, // 197
			{1, 2, 6, 7, 0, 0, 0, 0}, // 198
			{0, 1, 2, 6, 7, 0, 0, 0}, // 199
			{3, 6, 7, 0, 0, 0, 0, 0}, // 200
			{0, 3, 6, 7, 0, 0, 0, 0}, // 201
			{1, 3, 6, 7, 0, 0, 0, 0}, // 202
			{0, 1, 3, 6, 7, 0, 0, 0}, // 203
			{2, 3, 6, 7, 0, 0, 0, 0}, // 204
			{0, 2, 3, 6, 7, 0, 0, 0}, // 205
			{1, 2, 3, 6, 7, 0, 0, 0}, // 206
			{0, 1, 2, 3, 6, 7, 0, 0}, // 207
			{4, 6, 7, 0, 0, 0, 0, 0}, // 208
			{0, 4, 6, 7, 0, 0, 0, 0}, // 209
			{1, 4, 6, 7, 0, 0, 0, 0}, // 210
			{0, 1, 4, 6, 7, 0, 0, 0}, // 211
			{2, 4, 6, 7, 0, 0, 0, 0}, // 212
			{0, 2, 4, 6, 7, 0, 0, 0}, // 213
			{1, 2, 4, 6, 7, 0, 0, 0}, // 214
			{0, 1, 2, 4, 6, 7, 0, 0}, // 215
			{3, 4, 6, 7, 0, 0, 0, 0}, // 216
			{0, 3, 4, 6, 7, 0, 0, 0}, // 217
			{1, 3, 4, 6, 7, 0, 0, 0}, // 218
			{0, 1, 3, 4, 6, 7, 0, 0}, // 219
			{2, 3, 4, 6, 7, 0, 0, 0}, // 220
			{0, 2, 3, 4, 6, 7, 0, 0}, // 221
			{1, 2, 3, 4, 6, 7, 0, 0}, // 222
			{0, 1, 2, 3, 4, 6, 7, 0}, // 223
			{5, 6, 7, 0, 0, 0, 0, 0}, // 224
			{0, 5, 6, 7, 0, 0, 0, 0}, // 225
			{1, 5, 6, 7, 0, 0, 0, 0}, // 226
			{0, 1, 5, 6, 7, 0, 0, 0}, // 227
			{2, 5, 6, 7, 0, 0, 0, 0}, // 228
			{0, 2, 5, 6, 7, 0, 0, 0}, // 229
			{1, 2, 5, 6, 7, 0, 0, 0}, // 230
			{0, 1, 2, 5, 6, 7, 0, 0}, // 231
			{3, 5, 6, 7, 0, 0, 0, 0}, // 232
			{0, 3, 5, 6, 7, 0, 0, 0}, // 233
			{1, 3, 5, 6, 7, 0, 0, 0}, // 234
			{0, 1, 3, 5, 6, 7, 0, 0}, // 235
			{2, 3, 5, 6, 7, 0, 0, 0}, // 236
			{0, 2, 3, 5, 6, 7, 0, 0}, // 237
			{1, 2, 3, 5, 6, 7, 0, 0}, // 238
			{0, 1, 2, 3, 5, 6, 7, 0}, // 239
			{4, 5, 6, 7, 0, 0, 0, 0}, // 240
			{0, 4, 5, 6, 7, 0, 0, 0}, // 241
			{1, 4, 5, 6, 7, 0, 0, 0}, // 242
			{0, 1, 4, 5, 6, 7, 0, 0}, // 243
			{2, 4, 5, 6, 7, 0, 0, 0}, // 244
			{0, 2, 4, 5, 6, 7, 0, 0}, // 245
			{1, 2, 4, 5, 6, 7, 0, 0}, // 246
			{0, 1, 2, 4, 5, 6, 7, 0}, // 247
			{3, 4, 5, 6, 7, 0, 0, 0}, // 248
			{0, 3, 4, 5, 6, 7, 0, 0}, // 249
			{1, 3, 4, 5, 6, 7, 0, 0}, // 250
			{0, 1, 3, 4, 5, 6, 7, 0}, // 251
			{2, 3, 4, 5, 6, 7, 0, 0}, // 252
			{0, 2, 3, 4, 5, 6, 7, 0}, // 253
			{1, 2, 3, 4, 5, 6, 7, 0}, // 254
			{0, 1, 2, 3, 4, 5, 6, 7}, // 255
		};

		constexpr static uint8_t shift_lut_8[256][16] = {
			{0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 0
			{0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 1
			{2, 3, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 2
			{0, 1, 2, 3, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 3
			{4, 5, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 4
			{0, 1, 4, 5, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 5
			{2, 3, 4, 5, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 6
			{0, 1, 2, 3, 4, 5, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 7
			{6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 8
			{0, 1, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 9
			{2, 3, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 10
			{0, 1, 2, 3, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 11
			{4, 5, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 12
			{0, 1, 4, 5, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 13
			{2, 3, 4, 5, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 14
			{0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 0, 1, 0, 1, 0, 1},  // 15
			{8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 16
			{0, 1, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 17
			{2, 3, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 18
			{0, 1, 2, 3, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 19
			{4, 5, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 20
			{0, 1, 4, 5, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 21
			{2, 3, 4, 5, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 22
			{0, 1, 2, 3, 4, 5, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1},  // 23
			{6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 24
			{0, 1, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 25
			{2, 3, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 26
			{0, 1, 2, 3, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1},  // 27
			{4, 5, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 28
			{0, 1, 4, 5, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1},  // 29
			{2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1, 0, 1},  // 30
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 0, 1, 0, 1},  // 31
			{10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 32
			{0, 1, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 33
			{2, 3, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 34
			{0, 1, 2, 3, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 35
			{4, 5, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 36
			{0, 1, 4, 5, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 37
			{2, 3, 4, 5, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 38
			{0, 1, 2, 3, 4, 5, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 39
			{6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 40
			{0, 1, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 41
			{2, 3, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 42
			{0, 1, 2, 3, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 43
			{4, 5, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 44
			{0, 1, 4, 5, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 45
			{2, 3, 4, 5, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 46
			{0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 0, 1, 0, 1, 0, 1},  // 47
			{8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 48
			{0, 1, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 49
			{2, 3, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 50
			{0, 1, 2, 3, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 51
			{4, 5, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 52
			{0, 1, 4, 5, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 53
			{2, 3, 4, 5, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 54
			{0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1},  // 55
			{6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 56
			{0, 1, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 57
			{2, 3, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 58
			{0, 1, 2, 3, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1},  // 59
			{4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1, 0, 1},  // 60
			{0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1},  // 61
			{2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1, 0, 1},  // 62
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 0, 1},  // 63
			{12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 64
			{0, 1, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 65
			{2, 3, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 66
			{0, 1, 2, 3, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 67
			{4, 5, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 68
			{0, 1, 4, 5, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 69
			{2, 3, 4, 5, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 70
			{0, 1, 2, 3, 4, 5, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 71
			{6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 72
			{0, 1, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 73
			{2, 3, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 74
			{0, 1, 2, 3, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 75
			{4, 5, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 76
			{0, 1, 4, 5, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 77
			{2, 3, 4, 5, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 78
			{0, 1, 2, 3, 4, 5, 6, 7, 12, 13, 0, 1, 0, 1, 0, 1},  // 79
			{8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 80
			{0, 1, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 81
			{2, 3, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 82
			{0, 1, 2, 3, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 83
			{4, 5, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 84
			{0, 1, 4, 5, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 85
			{2, 3, 4, 5, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 86
			{0, 1, 2, 3, 4, 5, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1},  // 87
			{6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 88
			{0, 1, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 89
			{2, 3, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 90
			{0, 1, 2, 3, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1},  // 91
			{4, 5, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 92
			{0, 1, 4, 5, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1},  // 93
			{2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1, 0, 1},  // 94
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 0, 1, 0, 1},  // 95
			{10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 96
			{0, 1, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 97
			{2, 3, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 98
			{0, 1, 2, 3, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 99
			{4, 5, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 100
			{0, 1, 4, 5, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 101
			{2, 3, 4, 5, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 102
			{0, 1, 2, 3, 4, 5, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 103
			{6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 104
			{0, 1, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 105
			{2, 3, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 106
			{0, 1, 2, 3, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 107
			{4, 5, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 108
			{0, 1, 4, 5, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 109
			{2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 110
			{0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 0, 1, 0, 1},  // 111
			{8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 112
			{0, 1, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 113
			{2, 3, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 114
			{0, 1, 2, 3, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 115
			{4, 5, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 116
			{0, 1, 4, 5, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 117
			{2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 118
			{0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1},  // 119
			{6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1, 0, 1},  // 120
			{0, 1, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 121
			{2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 122
			{0, 1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1},  // 123
			{4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1, 0, 1},  // 124
			{0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1},  // 125
			{2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1, 0, 1},  // 126
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 0, 1},  // 127
			{14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 128
			{0, 1, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 129
			{2, 3, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 130
			{0, 1, 2, 3, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 131
			{4, 5, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 132
			{0, 1, 4, 5, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 133
			{2, 3, 4, 5, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 134
			{0, 1, 2, 3, 4, 5, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 135
			{6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 136
			{0, 1, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 137
			{2, 3, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 138
			{0, 1, 2, 3, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 139
			{4, 5, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 140
			{0, 1, 4, 5, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 141
			{2, 3, 4, 5, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 142
			{0, 1, 2, 3, 4, 5, 6, 7, 14, 15, 0, 1, 0, 1, 0, 1},  // 143
			{8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 144
			{0, 1, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 145
			{2, 3, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 146
			{0, 1, 2, 3, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 147
			{4, 5, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 148
			{0, 1, 4, 5, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 149
			{2, 3, 4, 5, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 150
			{0, 1, 2, 3, 4, 5, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1},  // 151
			{6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 152
			{0, 1, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 153
			{2, 3, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 154
			{0, 1, 2, 3, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1},  // 155
			{4, 5, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 156
			{0, 1, 4, 5, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1},  // 157
			{2, 3, 4, 5, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1, 0, 1},  // 158
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 14, 15, 0, 1, 0, 1},  // 159
			{10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 160
			{0, 1, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 161
			{2, 3, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 162
			{0, 1, 2, 3, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 163
			{4, 5, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 164
			{0, 1, 4, 5, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 165
			{2, 3, 4, 5, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 166
			{0, 1, 2, 3, 4, 5, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 167
			{6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 168
			{0, 1, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 169
			{2, 3, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 170
			{0, 1, 2, 3, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 171
			{4, 5, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 172
			{0, 1, 4, 5, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 173
			{2, 3, 4, 5, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 174
			{0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 14, 15, 0, 1, 0, 1},  // 175
			{8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 176
			{0, 1, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 177
			{2, 3, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 178
			{0, 1, 2, 3, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 179
			{4, 5, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 180
			{0, 1, 4, 5, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 181
			{2, 3, 4, 5, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 182
			{0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1},  // 183
			{6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 184
			{0, 1, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 185
			{2, 3, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 186
			{0, 1, 2, 3, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1},  // 187
			{4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1, 0, 1},  // 188
			{0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1},  // 189
			{2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1, 0, 1},  // 190
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 0, 1},  // 191
			{12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 192
			{0, 1, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 193
			{2, 3, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 194
			{0, 1, 2, 3, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 195
			{4, 5, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 196
			{0, 1, 4, 5, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 197
			{2, 3, 4, 5, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 198
			{0, 1, 2, 3, 4, 5, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 199
			{6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 200
			{0, 1, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 201
			{2, 3, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 202
			{0, 1, 2, 3, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 203
			{4, 5, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 204
			{0, 1, 4, 5, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 205
			{2, 3, 4, 5, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 206
			{0, 1, 2, 3, 4, 5, 6, 7, 12, 13, 14, 15, 0, 1, 0, 1},  // 207
			{8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 208
			{0, 1, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 209
			{2, 3, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 210
			{0, 1, 2, 3, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 211
			{4, 5, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 212
			{0, 1, 4, 5, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 213
			{2, 3, 4, 5, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 214
			{0, 1, 2, 3, 4, 5, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1},  // 215
			{6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 216
			{0, 1, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 217
			{2, 3, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 218
			{0, 1, 2, 3, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1},  // 219
			{4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 220
			{0, 1, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1},  // 221
			{2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1, 0, 1},  // 222
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 0, 1},  // 223
			{10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1},  // 224
			{0, 1, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 225
			{2, 3, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 226
			{0, 1, 2, 3, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 227
			{4, 5, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 228
			{0, 1, 4, 5, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 229
			{2, 3, 4, 5, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 230
			{0, 1, 2, 3, 4, 5, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 231
			{6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 232
			{0, 1, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 233
			{2, 3, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 234
			{0, 1, 2, 3, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 235
			{4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 236
			{0, 1, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 237
			{2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 238
			{0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 0, 1},  // 239
			{8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1, 0, 1},  // 240
			{0, 1, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 241
			{2, 3, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 242
			{0, 1, 2, 3, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 243
			{4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 244
			{0, 1, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 245
			{2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 246
			{0, 1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1},  // 247
			{6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1, 0, 1},  // 248
			{0, 1, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 249
			{2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 250
			{0, 1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1},  // 251
			{4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 0, 1},  // 252
			{0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1},  // 253
			{2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1},  // 254
			{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15},  // 255
		};
	}
}